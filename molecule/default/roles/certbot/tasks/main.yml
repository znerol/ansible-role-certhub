---
- name: ACME clients setup
  become: yes
  become_user: root
  block:
    - name: EPEL repo present
      when: ansible_pkg_mgr == 'dnf'
      package:
        name: epel-release
        state: present

    - name: PPA present
      when: ansible_distribution == 'Ubuntu'
      apt_repository:
        repo: ppa:certbot/certbot
        codename: "{{ ansible_distribution_release }}"

    - name: Certbot present
      package:
        name:
          - certbot
        state: present
